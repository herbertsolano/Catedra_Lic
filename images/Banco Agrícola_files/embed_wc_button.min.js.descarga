var body_client,s1chat_iframe=document.getElementById("s1chat_iframe"),iframe_loading=document.getElementById("iframe-loading"),s1chat_iframe_wrapper=document.getElementById("s1chat_iframe_wrapper"),s1chat_welcome_wrapper=document.getElementById("s1chat_welcome_wrapper"),s1chat_notify_bubble=document.getElementById("s1chat_notify_bubble"),s1chat_btn=document.getElementById("s1_chat_btn"),originalH="",showed_s1chat_iframe=!1,blocked=!1,wc_qs="",iFrameSrc=!1;function setIFrameSource(e,t){var a=document.getElementById(e);null!==a&&(a.src?a.src=t:null!==a.contentWindow&&null!==a.contentWindow.location?a.contentWindow.location=t:a.setAttribute("src",t),iFrameSrc=!0)}function loadIframeDisplay(){s1chat_iframe.style.display="block",iframe_loading.style.display="none"}function initMinimizedChat(){0==iFrameSrc&&(addEventCrossBrowser("load",s1chat_iframe,loadIframeDisplay),setIFrameSource("s1chat_iframe",_s1ChatUrl)),showS1ChatButton()}function showChat(e){if(!blocked){if(blocked=!0,setTimeout(function(){blocked=!1},1e3),0==iFrameSrc||!isEmpty(e)){setIFrameSource("s1chat_iframe",""),addEventCrossBrowser("load",s1chat_iframe,loadIframeDisplay);var t=window.location.href,a=getParameterByNameFromStr("origen",wc_qs),s=getParameterByNameFromStr("s1_origin",wc_qs);s1IsEmpty(wc_qs)||s1IsEmpty(a)&&s1IsEmpty(s)||(t=s1IsEmpty(a)?s:a);var i=isEmpty(e)?"":"&s1_offer="+e,n=_s1ChatUrl+i+wc_qs+"&s1d=1&s1_origin="+encodeURIComponent(Base64.encode(t));if(isDevice("iOS")){var o=window.open(n,"MsgWindow","toolbar=no, status=no, menubar=no, scrollbars=no, resizable=no, left=10000, top=10000, width=10, height=10, visible=none","");setTimeout(function(){o.close(),setIFrameSource("s1chat_iframe",n)},2e3)}else setIFrameSource("s1chat_iframe",n)}addClass(body_client,"s1-chat-opened"),s1chat_iframe_wrapper.style.display="block",removeClass(s1chat_iframe_wrapper,"fadeOutDown animated"),addClass(s1chat_iframe_wrapper,"fadeInUp animated"),removeClass(s1chat_welcome_wrapper,"flipInX animated"),removeClass(s1chat_btn,"s1-new-message"),s1chat_welcome_wrapper.style.display="none",showed_s1chat_iframe=!showed_s1chat_iframe,resizeChatWrapper()}}function hideChat(){blocked||(blocked=!0,setTimeout(function(){blocked=!1},1e3),removeClass(body_client,"s1-chat-opened"),removeClass(s1chat_iframe_wrapper,"fadeInUp animated"),addClass(s1chat_iframe_wrapper,"fadeOutDown animated"),setTimeout(function(){s1chat_iframe_wrapper.style.display="none"},500),showS1ChatButton(),showed_s1chat_iframe=!showed_s1chat_iframe)}function resizeChatWrapper(){if(!isDevice("phone")&&(winH=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,showed_s1chat_iframe&&winH!==s1chat_iframe_wrapper.clientHeight)){""===originalH&&(originalH=s1chat_iframe_wrapper.clientHeight);var e=originalH;winH<originalH&&(e=winH),s1chat_iframe_wrapper.style.height=e+"px",s1chat_iframe_wrapper.style.display="block",s1chat_iframe_wrapper.setAttribute("style",s1chat_iframe_wrapper.getAttribute("style").replace("height: "+e+"px","height: "+e+"px !important"))}}function showS1ChatButton(){s1chat_welcome_wrapper.style.display="block",addClass(s1chat_welcome_wrapper,"flipInX animated")}function switchState(e){switch(e){case"s1_conversationInitialized":addClass(s1chat_welcome_wrapper,"s1-conversation-initialized");break;case"s1_conversationFinalized":removeClass(s1chat_welcome_wrapper,"s1-conversation-initialized"),removeClass(s1chat_btn,"s1-new-message");break;case"s1_newMessage":"block"==s1chat_welcome_wrapper.style.display&&addClass(s1chat_btn,"s1-new-message")}}function initS1WelcomeChat(){setTimeout(function(){body_client=document.getElementsByTagName("html")[0],addClass(body_client,"s1-chat-initilized"),initDeviceDetect(),addDeviceClassesToHtmlTag();var e="undefined"!=typeof _wc_chatid?_wc_chatid:"",t="undefined"!=typeof _wc_small?_wc_small:"0";s1IsEmpty(e)?(wc_qs="undefined"!=typeof _wc_qs?"&"+_wc_qs:"",showS1ChatButton()):(switchState("s1_conversationInitialized"),"1"==t||hasClass(s1chat_welcome_wrapper,"wc_small")?initMinimizedChat():showChat())},100)}resizeChatWrapper(),addEventCrossBrowser("resize",window,resizeChatWrapper),addEventCrossBrowser("message",window,function(e){if(null!==e.data&&void 0!==e.data&&("s1_hideChat"==e.data&&hideChat(),"s1_conversationInitialized"==e.data&&switchState(e.data),"s1_conversationFinalized"==e.data&&switchState(e.data),s1chat_notify_bubble&&"s1_newMessage"==e.data)){var t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;s1chat_notify_bubble.style.bottom=t-(s1chat_welcome_wrapper.offsetTop+10)+"px",s1chat_notify_bubble.style.left=s1chat_welcome_wrapper.offsetLeft+s1chat_welcome_wrapper.clientWidth-25+"px",switchState(e.data)}}),initS1WelcomeChat();